import{_ as H,J as X,r as n,C,o as Z,a as ee,b as f,c as m,d as g,e as t,t as h,Q as E,f as le,j as A,m as d,P as ae,w as te,F as z,h as M,R as D,S as U,g as se,k as oe,T as ie,p as ue,q as re,U as x}from"./index-fb047ced.js";import{_ as ne}from"./breadcrumb-7f4f9afa.js";import{_ as de}from"./Nave-d09016a1.js";import{_ as ve}from"./Footer-bccb6e38.js";/* empty css                                             */const F=P=>(ue("data-v-b022a331"),P=P(),re(),P),ce=["dir"],pe=F(()=>t("div",{class:"absolute bg-black opacity-40 w-full h-full z-50"},null,-1)),fe=F(()=>t("img",{class:"w-full absolute h-full object-cover",src:ne,alt:"Banner background"},null,-1)),me={class:"z-50 text-white w-full m-auto w-[80%]"},he={class:"font-bold text-5xl text-white z-50"},_e={class:"flex py-8"},ge={class:"text-2xl font-semibold"},ye=F(()=>t("path",{d:"M0.999878 6.49976L16.9999 6.49976",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),be=F(()=>t("path",{d:"M5.99972 11.5C5.99972 11.5 0.999767 7.81756 0.999756 6.49996C0.999744 5.18237 5.99976 1.5 5.99976 1.5",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),$e=[ye,be],we={class:"text-2xl font-semibold"},ke={class:"bg-white auctions px-[2%] py-[3%] pt-[5%]"},xe={class:"text-3xl font-bold max-w-[1280px] p-4 m-auto"},Ae=["onSubmit"],Ve={class:"col-span-4"},Ie={class:"py-1 relative"},Oe={class:"flex"},Pe={class:"py-2 font-bold text-[#303843]",for:"name",id:"name-label"},Te={key:0,class:"my-auto text-[#AA1E22] px-1"},Ce={class:"py-1 relative"},Ee={class:"flex"},De={class:"py-2 font-bold text-[#303843]",for:"phone",id:"phone-label"},Fe={key:0,class:"my-auto text-[#AA1E22] px-1"},Se={key:0,class:"text-[#AA1E22] text-sm"},qe={class:"py-1 relative"},Be={class:"flex"},Me={class:"py-2 font-bold text-[#303843]",for:"email",id:"email-label"},Ue={key:0,class:"my-auto text-[#AA1E22] px-1"},je={key:0,class:"text-[#AA1E22] text-sm"},Le={class:"hidden"},ze={class:"col-span-2 mx-auto"},Re={class:"rounded-full",style:{border:"5px solid #AA1F23"}},Ke={key:1,class:"m-auto rounded-full bg-gray-200",style:{width:"200px",height:"200px"}},Ne={class:"mx-auto text-center w-full"},Ye={class:"mx-auto text-center w-full"},Qe={class:"underline text-[#DDAE05] font-bold text-xl"},Je={class:"bg-white py-6 px-10 rounded-lg"},We={key:0,class:"pb-1 w-full text-center text-[#AA1E22] font-bold",style:{"line-height":"29px"}},Ge={class:"relative"},He={style:{direction:"ltr"},class:"flex justify-center gap-2"},Xe={class:"flex justify-center"},Ze={setup(P){const c=X(),l=n({name:"",phone:"",email:"",profile:"",lang:localStorage.getItem("appLang")||"ar",user_id:localStorage.getItem("user_id")}),$=n({}),S=n(null),V=n(!1),u=n(["","","","","",""]),_=n(""),w=n(!1),I=n(!1),y=n(""),k=n([]),T=n({email:null,sms:null}),O=n({email:null,sms:null}),i=n([]),v=n(null),j=C(()=>{const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return!l.value.email||e.test(l.value.email)}),L=C(()=>{const e=/^\+?\d{10,15}$/;return!l.value.phone||e.test(l.value.phone)}),q=C(()=>l.value.name.trim()&&L.value&&j.value),B=C(()=>u.value.every(e=>e.match(/^[0-9]$/))),R=async()=>{w.value=!0;try{const e=await M.post("api/get_user_profile",{lang:l.value.lang,user_id:parseInt(l.value.user_id)});l.value={...e.data.result.data,lang:l.value.lang,user_id:l.value.user_id},$.value={...e.data.result.data}}catch{}finally{w.value=!1}},K=e=>{const a=e.target.files[0];if(a){if(!a.type.startsWith("image/")){c.add({severity:"error",summary:"خطأ",detail:$t("يرجى تحميل صورة فقط"),life:3e3});return}if(a.size>5*1024*1024){c.add({severity:"error",summary:"خطاء",detail:$t("حجم الصورة كبير جدًا"),life:3e3});return}const s=new FileReader;s.readAsDataURL(a),s.onload=o=>{l.value.profile=o.target.result,l.value.file=a}}},N=()=>{S.value?S.value.click():c.add({severity:"error",summary:"خطأ",detail:$t("لم يتم العثور على حقل إدخال الملف"),life:3e3})},Y=async()=>{if(!q.value){c.add({severity:"error",summary:"خطأ",detail:$t("يرجى ملء جميع الحقول المطلوبة بشكل صحيح"),life:3e3});return}w.value=!0;try{const e=new FormData;if(e.append("lang",l.value.lang),e.append("user_id",l.value.user_id),l.value.name!==$.value.name&&e.append("name",l.value.name),l.value.phone!==$.value.phone&&e.append("phone",l.value.phone),l.value.email!==$.value.email&&e.append("email",l.value.email),l.value.file&&e.append("profile",l.value.file),[...e.entries()].length<=2){c.add({severity:"info",summary:$t("بدون تغييرات"),detail:$t("لم يتم إجراء أي تغييرات"),life:3e3}),w.value=!1;return}const a=await M.post("api/update_user_profile",e,{headers:{"Content-Type":"multipart/form-data"}});if(a.data.result.code===200){k.value=[],T.value={email:null,sms:null},O.value={email:null,sms:null};const s=l.value.email!==$.value.email,o=l.value.phone!==$.value.phone;(s||o)&&(s&&(k.value.push("email"),T.value.email=a.data.result.data.request_id,O.value.email=a.data.result.data.email_code_validity_period),o&&(k.value.push("sms"),T.value.sms=a.data.result.data.sms_otp_validity_period?a.data.result.data.request_id:a.data.result.data.sms_request_id,O.value.sms=a.data.result.data.sms_otp_validity_period)),k.value.length>0?(y.value=k.value[0],V.value=!0,c.add({severity:"info",summary:$t("تم إرسال OTP"),detail:$t("تم إرسال رمز التحقق إلى ")+(y.value==="email"?l.value.email:l.value.phone)+$t("، صالح لمدة ")+O.value[y.value]+$t(" دقيقة"),life:5e3}),x(()=>{var r;(r=i.value[0])!=null&&r.$el&&(i.value[0].$el.focus(),v.value=0)})):(c.add({severity:"success",summary:$t("نجاح"),detail:$t("تم تحديث الملف الشخصي بنجاح"),life:3e3}),$.value={...l.value,file:null})}else c.add({severity:"error",summary:"خطأ",detail:a.data.result.message||$t("فشل في تحديث الملف الشخصي"),life:3e3})}catch{c.add({severity:"error",summary:"خطأ",detail:$t("فشل في تحديث الملف الشخصي"),life:3e3})}finally{w.value=!1}},Q=(e,a)=>{const s=a.target.value.replace(/[^0-9]/g,"").slice(0,1);s.length>0?(u.value[e]=s,_.value="",e<u.value.length-1&&x(()=>{var o;(o=i.value[e+1])!=null&&o.$el&&(i.value[e+1].$el.focus(),v.value=e+1)})):(u.value[e]="",_.value="")},J=e=>{const s=(e.clipboardData||window.clipboardData).getData("text").trim().match(/\d/g);if(s&&s.length>=u.value.length){for(let o=0;o<u.value.length;o++)u.value[o]=s[o]||"";_.value="",x(()=>{var r;const o=u.value.length-1;(r=i.value[o])!=null&&r.$el&&(i.value[o].$el.focus(),v.value=o)})}else _.value=$t("رمز OTP غير صالح");e.preventDefault()},W=(e,a)=>{a.key==="Backspace"?!u.value[e]&&e>0&&(a.preventDefault(),x(()=>{var s;(s=i.value[e-1])!=null&&s.$el&&(i.value[e-1].$el.focus(),v.value=e-1)})):a.key==="ArrowLeft"&&e>0?x(()=>{var s;(s=i.value[e-1])!=null&&s.$el&&(i.value[e-1].$el.focus(),v.value=e-1)}):a.key==="ArrowRight"&&e<u.value.length-1&&x(()=>{var s;(s=i.value[e+1])!=null&&s.$el&&(i.value[e+1].$el.focus(),v.value=e+1)})},G=async()=>{if(!B.value){_.value=$t("يرجى إدخال رمز OTP كامل");return}I.value=!0;try{const e=await M.post("api/user_profile_verfication",{lang:l.value.lang,user_id:parseInt(l.value.user_id),verfy_with:y.value,request_id:T.value[y.value],verfication_code:u.value.join("")});e.data.result.code===200?e.data.result.data.verfid===!1?(_.value=$t("رمز OTP غير صحيح، يرجى إدخاله مرة أخرى"),u.value=["","","","","",""],x(()=>{var a;(a=i.value[0])!=null&&a.$el&&(i.value[0].$el.focus(),v.value=0)})):(c.add({severity:"success",summary:$t("نجاح"),detail:$t("تم التحقق بنجاح"),life:3e3}),k.value.shift(),u.value=["","","","","",""],_.value="",v.value=null,k.value.length>0?(y.value=k.value[0],c.add({severity:"info",summary:$t("تم إرسال OTP"),detail:$t("تم إرسال رمز التحقق إلى ")+(y.value==="email"?l.value.email:l.value.phone)+$t("، صالح لمدة ")+O.value[y.value]+$t(" دقيقة"),life:5e3}),x(()=>{var a;(a=i.value[0])!=null&&a.$el&&(i.value[0].$el.focus(),v.value=0)})):(V.value=!1,$.value={...l.value,file:null})):_.value=e.data.result.message||$t("فشل في التحقق من رمز OTP")}catch{c.add({severity:"error",summary:"خطأ",detail:$t("فشل في التحقق من رمز OTP"),life:3e3})}finally{I.value=!1}};return Z(()=>{R()}),(e,a)=>{var o;const s=ee("Toast");return f(),m(z,null,[g(de),t("div",{class:"banner flex items-center h-[35vh] lg:h-[55vh] relative",dir:l.value.lang==="ar"?"rtl":"ltr"},[pe,fe,t("div",me,[t("h1",he,h(e.$t("الصفحه الشخصيه")),1),t("div",_e,[t("p",ge,h(e.$t("home")),1),(f(),m("svg",{class:E(["my-auto mx-[1%]",{"ltr:rotate-180":l.value.lang==="ar"}]),width:"18",height:"13",viewBox:"0 0 18 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},$e,2)),t("p",we,h(e.$t("الصفحه الشخصيه")),1)])])],8,ce),t("div",ke,[t("p",xe,h(e.$t("المعلومات الشخصيه")),1),t("form",{onSubmit:le(Y,["prevent"]),class:"max-w-[1280px] shadow-md grid grid-cols-1 p-4 sm:grid-cols-2 lg:grid-cols-6 gap-4 m-auto"},[t("div",Ve,[t("div",Ie,[t("div",Oe,[t("label",Pe,h(e.$t("full_name")),1),l.value.name?A("",!0):(f(),m("span",Te,"*"))]),g(d(D),{id:"name",required:"","aria-labelledby":"name-label",class:"bg-[#f7f5f5] w-full",modelValue:l.value.name,"onUpdate:modelValue":a[0]||(a[0]=r=>l.value.name=r),placeholder:e.$t("full_name")},null,8,["modelValue","placeholder"])]),t("div",Ce,[t("div",Ee,[t("label",De,h(e.$t("Mobile_number")),1),l.value.phone?A("",!0):(f(),m("span",Fe,"*"))]),g(d(D),{id:"phone",required:"","aria-labelledby":"phone-label",class:"bg-[#f7f5f5] w-full",modelValue:l.value.phone,"onUpdate:modelValue":a[1]||(a[1]=r=>l.value.phone=r),placeholder:e.$t("Mobile_number")},null,8,["modelValue","placeholder"]),!d(L)&&l.value.phone?(f(),m("div",Se,h(e.$t("الرجاء إدخال رقم هاتف صحيح")),1)):A("",!0)]),t("div",qe,[t("div",Be,[t("label",Me,h(e.$t("Your_email_address")),1),l.value.email?A("",!0):(f(),m("span",Ue,"*"))]),g(d(D),{id:"email",required:"","aria-labelledby":"email-label",class:"bg-[#f7f5f5] w-full",modelValue:l.value.email,"onUpdate:modelValue":a[2]||(a[2]=r=>l.value.email=r),placeholder:e.$t("Your_email_address")},null,8,["modelValue","placeholder"]),!d(j)&&l.value.email?(f(),m("div",je,h(e.$t("الرجاء إدخال بريد إلكتروني صحيح")),1)):A("",!0)]),t("div",Le,[t("input",{ref_key:"fileInput",ref:S,onChange:K,accept:"image/*",id:"file",type:"file","aria-labelledby":"file-label"},null,544)]),g(d(U),{type:"submit",disabled:w.value||!d(q),class:E([{"opacity-50 cursor-not-allowed":w.value||!d(q)},"mt-3 w-[90%] mx-auto lg:mb-0 bg-primary text-white font-bold py-3 rounded-lg hover:bg-primary-hover focus:outline-none focus:ring-2 focus:ring-[#AA1E22] transition-colors duration-200"]),label:w.value?e.$t("جاري التحميل..."):e.$t("تعديل")},null,8,["disabled","class","label"])]),t("div",ze,[t("div",Re,[(o=l.value)!=null&&o.profile?(f(),m("div",{key:0,class:"m-auto rounded-full bg-no-repeat bg-cover",style:ae([{width:"200px",height:"200px"},{backgroundImage:`url(${l.value.profile})`}])},null,4)):(f(),m("div",Ke))]),t("div",Ne,[g(d(U),{onClick:N,class:"mt-3 w-[90%] mx-auto lg:mb-0 bg-primary text-white font-bold py-3 rounded-lg hover:bg-primary-hover focus:outline-none focus:ring-2 focus:ring-[#AA1E22] transition-colors duration-200",label:e.$t("تعديل")},null,8,["label"])]),t("div",Ye,[t("p",Qe,h(e.$t("اكمل حسابك")),1)])])],40,Ae),g(d(ie),{visible:V.value,"onUpdate:visible":a[5]||(a[5]=r=>V.value=r),modal:!0,header:e.$t("ادخل رمز ال OTP")+` (${y.value==="email"?e.$t("Your_email_address"):e.$t("Mobile_number")})`,class:"w-[90%] max-w-[500px] dir-rtl"},{default:te(()=>[t("div",Je,[_.value?(f(),m("p",We,h(_.value),1)):A("",!0),t("div",Ge,[t("div",He,[(f(!0),m(z,null,se(u.value,(r,b)=>(f(),oe(d(D),{key:b,ref_for:!0,ref:p=>{p&&(i.value[b]=p)},modelValue:u.value[b],"onUpdate:modelValue":p=>u.value[b]=p,type:"text",inputmode:"numeric",pattern:"[0-9]*",maxlength:"1",placeholder:"-",class:E(["w-12 h-14 text-center text-lg font-bold border border-gray-300 rounded-lg focus:outline-none transition-colors duration-200",{"ring-2 ring-[#AA1E22] bg-red-50":v.value===b||b===0&&v.value===null&&V.value}]),onInput:p=>Q(b,p),onPaste:a[3]||(a[3]=p=>J(p)),onKeydown:p=>W(b,p),onFocus:p=>v.value=b,onBlur:a[4]||(a[4]=p=>v.value=null)},null,8,["modelValue","onUpdate:modelValue","class","onInput","onKeydown","onFocus"]))),128))])]),t("div",Xe,[g(d(U),{label:I.value?e.$t("جاري التحميل..."):e.$t("تأكيد"),disabled:!d(B)||I.value,class:E([{"opacity-50 cursor-not-allowed":!d(B)||I.value},"mt-3 w-full lg:w-[70%] mx-auto bg-primary text-white font-bold py-3 rounded-lg hover:bg-primary-hover focus:outline-none focus:ring-2 focus:ring-[#AA1E22] transition-colors duration-200"]),onClick:G},null,8,["label","disabled","class"])])])]),_:1},8,["visible","header"])]),g(s),g(ve)],64)}}},ol=H(Ze,[["__scopeId","data-v-b022a331"]]);export{ol as default};
